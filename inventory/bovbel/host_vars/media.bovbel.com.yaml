---
pia_username: p4418147
pia_password: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  38383866646163623333386539326666363939323938643761396463343135303533346530663234
  3463326135353933613238323432303730653433336263620a363762333739633330363230376139
  33643133623438353734303732666232663765306565306363303039306435653834663663313134
  6163316363393166340a643936393235383464313664613230636637353363666337653939366561
  6136

# Useful paths
data_folder: /mnt/storage
app_folder: "{{ data_folder }}/app"
media_folder: "{{ data_folder }}/media"
backup_folder: "{{ data_folder }}/backup"
downloads_folder: "{{ data_folder }}/downloads"
share_folder: "{{ media_folder }}"
movies_folder: "{{ media_folder }}/movies"
tv_folder: "{{ media_folder }}/tv"
books_folder: "{{ media_folder }}/books"
comics_folder: "{{ media_folder }}/comics"

zfs_pool: storage

media_server: true

aws_alias_domains:
  - tower.bovbel.com
  - cs.bovbel.com
  - tf2.bovbel.com

docker_extras:
  services:
    plex:
      volumes:
        - "{{ media_folder }}:/mnt/storage/share:ro"
      x-systemd-requires: ['mnt-storage.mount']
    unifi:
      image: linuxserver/unifi-controller
      container_name: unifi
      network_mode: host
      volumes:
        - "{{ app_folder }}/unifi:/config"
      restart: "no"
      environment:
        PUID: "{{ uid }}"
        PGID: "{{ gid }}"
        TZ: America/Toronto
    deluge:
      environment:
        VPN_ENABLED: "yes"
        VPN_PROV: pia
        VPN_USER: "{{ pia_username }}"
        VPN_PASS: "{{ pia_password }}"
        VPN_CLIENT: wireguard
      x-systemd-start-post:
        # deluge thin client iptable rule to allow external access
        # https://github.com/binhex/arch-delugevpn/issues/139
        - "/sbin/iptables -t nat -A POSTROUTING -p tcp --dport 58846 -j SNAT --to-source {{ ansible_default_ipv4.address }}"
      x-systemd-requires: ['mnt-storage.mount']
    jellyfin:
      image: linuxserver/jellyfin
      container_name: jellyfin
      networks:
        - apps
      ports:
        - 8096:8096
      environment:
        PUID: "{{ uid }}"
        PGID: "{{ gid }}"
        TZ: America/Toronto
      volumes:
        - "{{ app_folder }}/jellyfin:/config"
        - "{{ media_folder }}:/data:ro"
      devices:
        - /dev/dri:/dev/dri
      restart: "no"
      x-systemd-requires: ['mnt-storage.mount']
    tautulli:
      x-systemd-requires: ['mnt-storage.mount']
    sonarr:
      x-systemd-requires: ['mnt-storage.mount']
    radarr:
      x-systemd-requires: ['mnt-storage.mount']
    jackett:
      x-systemd-requires: ['mnt-storage.mount']
    resilio:
      image: linuxserver/resilio-sync
      container_name: resilio
      networks:
        - apps
      ports:
        - 55555:55555
        - 55555:55555/udp
      volumes:
        - "{{ app_folder }}/resilio:/config"
        - "{{ data_folder }}:/sync"
      restart: "no"
      environment:
        PUID: "{{ uid }}"
        PGID: "{{ gid }}"
        TZ: America/Toronto
      x-systemd-requires:
        - mnt-storage.mount
    # minecraft:
    #   image: itzg/minecraft-server
    #   container_name: minecraft
    #   networks:
    #     - apps
    #   ports:
    #     - "25565:25565"
    #   volumes:
    #     - "{{ app_folder }}/minecraft:/data"
    #   environment:
    #     UID: "{{ uid }}"
    #     GID: "{{ gid }}"
    #     EULA: "TRUE"
    #     MAX_MEMORY: "16G"
    #     ENABLE_AUTOPAUSE: "TRUE"
    #     WHITELIST: "{{ minecraft_users | join(',') }}"
    #     OPS: "{{ minecraft_ops | join(',') }}"
    #     ENABLE_RCON: "TRUE"
    #     RCON_PASSWORD: "{{ web_password }}"
    #     TYPE: PAPER
    #   restart: "no"
    #   x-systemd-requires: ['mnt-storage.mount']
    csgo:
      image: cm2network/csgo:sourcemod
      container_name: csgo
      networks:
        - apps
      ports:
        - "27015:27015/tcp"
        - "27015:27015/udp"
      volumes:
        - type: bind
          source: "{{ app_folder }}/csgo"
          target: /home/steam/csgo-dedicated/
      environment:
        SRCDS_TOKEN: "{{ csgo_app_id }}" # (from: https://steamcommunity.com/dev/managegameservers)
        SRCDS_RCONPW: "{{ csgo_server_password }}" # (value can be overwritten by csgo/cfg/server.cfg)
        SRCDS_PW: "{{ csgo_server_password }}" # (value can be overwritten by csgo/cfg/server.cfg)
        SRCDS_FPSMAX: 300
        SRCDS_TICKRATE: 128
        SRCDS_MAXPLAYERS: 14
        SRCDS_STARTMAP: "de_dust2"
        SRCDS_REGION: 3
        SRCDS_MAPGROUP: "mg_active"
        SRCDS_GAMETYPE: 0
        SRCDS_GAMEMODE: 1
        SRCDS_HOSTNAME: "cs.bovbel.com" # (first launch only)
        # SRCDS_WORKSHOP_START_MAP: 0
        # SRCDS_HOST_WORKSHOP_COLLECTION: 0
        # SRCDS_WORKSHOP_AUTHKEY: "" # (required to use host_workshop_map)
        # ADDITIONAL_ARGS: "" # (Pass additional arguments to srcds. Make sure to escape correctly!)
        SOURCEMOD_ADMINS: "{{ csgo_admins | join(',') }}"
      restart: "no"
      x-systemd-requires: ['mnt-storage.mount']
    # tf2:
    #   image: cm2network/tf2:sourcemod
    #   container_name: tf2
    #   networks:
    #     - apps
    #   ports:
    #     - "27016:27016/tcp"
    #     - "27016:27016/udp"
    #   volumes:
    #     - type: bind
    #       source: "{{ app_folder }}/tf2"
    #       target: /home/steam/tf-dedicated/
    #   environment:
    #     SRCDS_TOKEN: !vault |
    #       $ANSIBLE_VAULT;1.1;AES256
    #       31306665316239303438653034626235656466393536383737343666313833353334643235396434
    #       3130386662316564383966356163626630653764323464360a633839366262643064326537303733
    #       66316530666162366239353438663663636431393630396438376238373362363261653061363636
    #       6535383062373964360a366132323563393836393764386530326464303763326435636662333666
    #       39353238343436393464313831323265373662656135323063373635376432373563656539383961
    #       3630366262303239323035323135346364396265633639363134
    #     SRCDS_RCONPW: "{{ csgo_server_password }}" # (value can be overwritten by csgo/cfg/server.cfg)
    #     SRCDS_PW: "{{ csgo_server_password }}" # (value can be overwritten by csgo/cfg/server.cfg)
    #     SRCDS_PORT: 27016
    #     # SRCDS_TV_PORT: 27020
    #     # SRCDS_NET_PUBLIC_ADDRESS: "0" # (public facing ip, useful for local network setups)
    #     # SRCDS_IP: "0" # (local ip to bind)
    #     # SRCDS_LAN: "0"
    #     SRCDS_FPSMAX: 300
    #     SRCDS_TICKRATE: 128
    #     SRCDS_MAXPLAYERS: 14
    #     SRCDS_STARTMAP: "cp_badlands"
    #     # SRCDS_REGION: 3
    #     # SRCDS_MAPGROUP: "mg_active"
    #     # SRCDS_GAMETYPE: 0
    #     # SRCDS_GAMEMODE: 1
    #     SRCDS_HOSTNAME: "tf2.bovbel.com" # (first launch only)
    #     # SRCDS_WORKSHOP_START_MAP: 0
    #     # SRCDS_HOST_WORKSHOP_COLLECTION: 0
    #     # SRCDS_WORKSHOP_AUTHKEY: "" # (required to use host_workshop_map)
    #     # ADDITIONAL_ARGS: "" # (Pass additional arguments to srcds. Make sure to escape correctly!)
    #     SOURCEMOD_ADMINS: "{{ csgo_admins | join(',') }}"
    #   restart: "no"
    #   x-systemd-requires: ['mnt-storage.mount']
    # valheim:
    #   image: mbround18/valheim:latest
    #   container_name: valheim
    #   ports:
    #     - 2456:2456/udp
    #     - 2457:2457/udp
    #     - 2458:2458/udp
    #   environment:
    #     PUID: "{{ uid }}"
    #     PGID: "{{ gid }}"
    #     TZ: America/Toronto
    #     PORT: 2456
    #     NAME: "valheim.bovbel.com"
    #     WORLD: "World"
    #     PASSWORD: "{{ csgo_server_password }}"
    #     PUBLIC: 1
    #     AUTO_UPDATE: 1
    #     AUTO_UPDATE_SCHEDULE: "0 5 * * *"
    #     UPDATE_ON_STARTUP: 1
    #     AUTO_BACKUP: 1
    #     AUTO_BACKUP_SCHEDULE: "*/15 * * * *"
    #     AUTO_BACKUP_REMOVE_OLD: 1
    #     AUTO_BACKUP_DAYS_TO_LIVE: 5
    #     AUTO_BACKUP_ON_UPDATE: 1
    #     AUTO_BACKUP_ON_SHUTDOWN: 1
    #   volumes:
    #     - "{{ app_folder }}/valheim/saves:/home/steam/.config/unity3d/IronGate/Valheim"
    #     - "{{ app_folder }}/valheim/server:/home/steam/valheim"
    #     - "{{ app_folder }}/valheim/backups:/home/steam/backups"
    #   restart: "no"
    #   x-systemd-requires: ['mnt-storage.mount']


caddy_extras:
  users:
    - name: paul@bovbel.com
      roles: ['admin', 'share']
    - name: rebecca@bovbel.com
      roles: ['admin', 'share']
    - name: andrew@bovbel.com
      roles: ['share']
    - name: igorlitvinov@gmail.com
      roles: ['share']
    - name: eugene.tkach@gmail.com
      roles: ['share']


  endpoints:
    jellyfin:
      type: proxy
      auth: null
      path: /jellyfin
      host: jellyfin
      port: 8096
      roles: ['admin']
    resilio:
      type: proxy
      auth: oauth
      path: /gui
      host: resilio
      port: 8888
      roles: ['admin']


csgo_server_password: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  39623639626633623466376534303537613431653232613764343239386337386638626162313636
  3832613261326133393532306438306535643961373166300a613764616135333865393639393137
  61306666326435653231646634373162393238363162363863666563346233396431636131343435
  3166393736383761360a346232633439316564653433653230323536323535313665613134383564
  3832
csgo_app_id: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  33613339643761323130633564656238636561313866353131326437346661356538303264326235
  3564376331373261366130386433666263623639636539630a633438306266656566336232393163
  61653666376234306334666366333862353432656564376630383038323734323938396265383161
  3366353032663833660a306661623136333933396261643336346162396436333961643535303733
  36393330353634333334316136623465336563323663323662336332383936613333353538663631
  3238646331343066623332613231303364353832373137376132

csgo_admins:
  - STEAM_0:0:33888781  # agentx3r
  - STEAM_0:0:8806779   # Supernatur4l

minecraft_ops:
  - agentx3r
  - LEVI00

minecraft_users:
  - _rusted_
  - agentx3r
  - FeelsKaleMan
  - landon0909
  - LEVI00
  - NovaNoot
  - rusnconcussion
  - sufferingtree11
  - SushiBeyblade85
  - ur_hot
